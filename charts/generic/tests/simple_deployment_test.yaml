suite: test deployment basics
templates:
  - deployment.yaml
tests:
  - it: should create deployment by default
    asserts:
      - hasDocuments:
          count: 1
      - isKind:
          of: Deployment
          documentIndex: 0
      - equal:
          path: metadata.name
          value: RELEASE-NAME
          documentIndex: 0

  - it: should not create deployment when disabled
    set:
      enabled: false
    asserts:
      - hasDocuments:
          count: 0

  - it: should set replicas
    set:
      replicas: 5
    asserts:
      - equal:
          path: spec.replicas
          value: 5

  - it: should add labels
    set:
      pod:
        labels:
          custom: label
          environment: test
    asserts:
      - equal:
          path: spec.template.metadata.labels.custom
          value: label
      - equal:
          path: spec.template.metadata.labels.environment
          value: test
